<!DOCTYPE html>
<html id="J-html" class="">
<head>
    <meta charset="UTF-8" />
    <title>
        
            机器学习算法之决策树和随机森林
        
    </title>
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="phy" />
    <meta name="description" content="决策树这种算法有着很多良好的特性，比如说训练时间复杂度较低，预测的过程比较快速，模型容易展示（容易将得到的决策树做成图片展示出来）等。但是同时，单决策树又有一些不好的地方，比如说容易over-fitting，虽然有一些方法，如剪枝可以减少这种情况，但是还是不够的。逻辑回归(Logistic Regression, LR)模型其实仅在线性回归的基础上，套用了一个逻辑函数，但也就由于这个逻辑函数，使得逻辑回归模型成为了机器学习领域一颗耀眼的明星，更是计算广告学的核心。" />
    <meta name="keywords" content="random forest,decision tree" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" type="text/css" media="all" href="../../../static/style.css" />
    <link rel="stylesheet" type="text/css" media="all" href="../../../static/pygments.css" />

    <!--[if lt IE 9]>
    <script src="http://pp1230.github.io/static/js/html5.js" type="text/javascript"></script>
    <![endif]-->
    <script src="http://pp1230.github.io/static/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>
<body itemscope itemtype="http://schema.org/WebPage" class="home blog lotus index">
    <nav class="lotus-nav">
        <ul>
            
            
            
            
            
                
            
            <li class="home ">
                <a href="/index.html" rel="bookmark" title="首页">
                    <i class="icon-home"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/archives.html" rel="bookmark" title="文章归档">
                    <i class="icon-reorder"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/contact.html" rel="bookmark" title="关于我">
                    <i class="icon-envelope-alt"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/love/pwd.html" rel="bookmark" title="love shuwei">
                    <i class="icon-heart"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/resource.html" rel="bookmark" title="资源">
                    <i class="icon-github"></i>
                </a>
                
            </li>
            
        </ul>
    </nav>

    <p class="lotus-breadcrub">
    <a href="http://pp1230.github.io/index.html" rel="nofollow" rel="nofollow" title="首页">Home</a>
    <span> &gt; </span>
    <a href="http://pp1230.github.io/archives.html" rel="nofollow" >Archives</a>
    <span> &gt; </span>
    机器学习算法之决策树和随机森林
</p>
<h1 class="lotus-pagetit">机器学习算法之决策树和随机森林</h1>
<p class="lotus-meta">Publish: <time class="date" pubdate="September  4, 2016">September  4, 2016</time></p>
<article  itemscope itemtype="http://schema.org/Article" class="lotus-post">
<blockquote>
  <p>决策树（Decision Tree）是一种简单但是广泛使用的分类器。通过训练数据构建决策树，可以高效的对未知的数据进行分类。决策数有两大优点：1）决策树模型可以读性好，具有描述性，有助于人工分析；2）效率高，决策树只需要一次构建，反复使用，每一次预测的最大计算次数不超过决策树的深度。但是同时，单决策树又有一些不好的地方，比如说容易over-fitting，虽然有一些方法，如剪枝可以减少这种情况，但是还是不够的。</p>
</blockquote>

<h2 id="section">1.决策树</h2>

<p>决策树实际上是将空间用超平面进行划分的一种方法，每次分割的时候，都将当前的空间一分为二，比如说下面的决策树：</p>
<p><img class="aligncenter size-full wp-image-21037" src="http://www.36dsj.com/wp-content/uploads/2015/01/113.png" alt="随机森林" width="240" height="169" /></p>
<p>就是将空间划分成下面的样子：</p>
<p><img class="aligncenter size-full wp-image-21038" src="http://www.36dsj.com/wp-content/uploads/2015/01/26.png" alt="随机森林" width="240" height="221" /></p>
<p>这样使得每一个叶子节点都是在空间中的一个不相交的区域，在进行决策的时候，会根据输入样本每一维feature的值，一步一步往下，最后使得样本落入N个区域中的一个（假设有N个叶子节点）</p>

<p><strong>基本步骤</strong></p>

<p>决策树构建的基本步骤如下：</p>

<ul>
  <li>
    <ol>
      <li>开始，所有记录看作一个节点</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>遍历每个变量的每一种分割方式，找到最好的分割点</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>分割成两个节点N1和N2</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>对N1和N2分别继续执行2-3步，直到每个节点足够“纯”为止</li>
    </ol>
  </li>
</ul>

<p><strong>决策树的变量可以有两种</strong>：</p>

<p>1） 数字型（Numeric）：变量类型是整数或浮点数，如前面例子中的“年收入”。用“&gt;=”，“&gt;”,“&lt;”或“&lt;=”作为分割条件（排序后，利用已有的分割情况，可以优化分割算法的时间复杂度）。</p>

<p>2） 名称型（Nominal）：类似编程语言中的枚举类型，变量只能重有限的选项中选取，比如前面例子中的“婚姻情况”，只能是“单身”，“已婚”或“离婚”。使用“=”来分割。</p>

<p>如何评估分割点的好坏？如果一个分割点可以将当前的所有节点分为两类，使得每一类都很“纯”，也就是同一类的记录较多，那么就是一个好分割点。比如上面的例子，“拥有房产”，可以将记录分成了两类，“是”的节点全部都可以偿还债务，非常“纯”；“否”的节点，可以偿还贷款和无法偿还贷款的人都有，不是很“纯”，但是两个节点加起来的纯度之和与原始节点的纯度之差最大，所以按照这种方法分割。构建决策树采用贪心算法，只考虑当前纯度差最大的情况作为分割点。</p>

<h2 id="section-1">2.随机森林</h2>

<p>随机森林是一个最近比较火的算法，它有很多的优点：</p>

<ul>
  <li>在数据集上表现良好</li>
  <li>在当前的很多数据集上，相对其他算法有着很大的优势</li>
  <li>它能够处理很高维度（feature很多）的数据，并且不用做特征选择</li>
  <li>在训练完后，它能够给出哪些feature比较重要</li>
  <li>在创建随机森林的时候，对generlization error使用的是无偏估计</li>
  <li>训练速度快</li>
  <li>在训练过程中，能够检测到feature间的互相影响</li>
  <li>容易做成并行化方法</li>
  <li>实现比较简单
随机森林顾名思义，是用随机的方式建立一个森林，森林里面有很多的决策树组成，随机森林的每一棵决策树之间是没有关联的。在得到森林之后，当有一个新的输 入样本进入的时候，就让森林中的每一棵决策树分别进行一下判断，看看这个样本应该属于哪一类（对于分类算法），然后看看哪一类被选择最多，就预测这个样本 为那一类。</li>
</ul>

<p>在建立每一棵决策树的过程中，有两点需要注意 - 采样与完全分裂。首先是两个随机采样的过程，random forest对输入的数据要进行行、列的采样。对于行采样，采用有放回的方式，也就是在采样得到的样本集合中，可能有重复的样本。假设输入样本为N个，那 么采样的样本也为N个。这样使得在训练的时候，每一棵树的输入样本都不是全部的样本，使得相对不容易出现over-fitting。然后进行列采样，从M 个feature中，选择m个(m « M)。之后就是对采样之后的数据使用完全分裂的方式建立出决策树，这样决策树的某一个叶子节点要么是无法继续分裂的，要么里面的所有样本的都是指向的同一 个分类。一般很多的决策树算法都一个重要的步骤 - 剪枝，但是这里不这样干，由于之前的两个随机采样的过程保证了随机性，所以就算不剪枝，也不会出现over-fitting。</p>

<p>按这种算法得到的随机森林中的每一棵都是很弱的，但是大家组合起来就很厉害了。我觉得可以这样比喻随机森林算法：每一棵决策树就是一个精通于某一个窄领域 的专家（因为我们从M个feature中选择m让每一棵决策树进行学习），这样在随机森林中就有了很多个精通不同领域的专家，对一个新的问题（新的输入数 据），可以用不同的角度去看待它，最终由各个专家，投票得到结果。</p>

<p>3.SparkML测试</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">println</span><span class="o">(</span><span class="s">"----------Decision Tree Classifier Test------------"</span><span class="o">)</span>
    <span class="c1">//读取数据含有标记和特征的数据
</span>    <span class="k">val</span> <span class="n">decisionTreeData</span> <span class="k">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">"libsvm"</span><span class="o">).</span><span class="n">load</span><span class="o">(</span><span class="s">"/home/pi/doc/Spark/spark-2.0.0-bin-hadoop2.7/data/mllib/test_decisiontreeclassification_data.txt"</span><span class="o">)</span>
    <span class="c1">//转化为ML Index
</span>    <span class="k">val</span> <span class="n">label</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StringIndexer</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setInputCol</span><span class="o">(</span><span class="s">"label"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setOutputCol</span><span class="o">(</span><span class="s">"indexedLabel"</span><span class="o">)</span>
        <span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">decisionTreeData</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">feature</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">VectorIndexer</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setInputCol</span><span class="o">(</span><span class="s">"features"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setOutputCol</span><span class="o">(</span><span class="s">"indexedFeatures"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">decisionTreeData</span><span class="o">)</span>
    <span class="c1">//将ML Index 转成String
</span>    <span class="k">val</span> <span class="n">convertor</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">IndexToString</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setInputCol</span><span class="o">(</span><span class="s">"prediction"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setOutputCol</span><span class="o">(</span><span class="s">"predictionLabel"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setLabels</span><span class="o">(</span><span class="n">label</span><span class="o">.</span><span class="n">labels</span><span class="o">)</span>
    <span class="c1">//决策树模型
</span>    <span class="k">val</span> <span class="n">dtc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">DecisionTreeClassifier</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setLabelCol</span><span class="o">(</span><span class="s">"indexedLabel"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setFeaturesCol</span><span class="o">(</span><span class="s">"indexedFeatures"</span><span class="o">)</span>
    <span class="c1">//将数据随机分为训练集和测试集
</span>    <span class="k">val</span> <span class="nc">Array</span><span class="o">(</span><span class="n">decisionTrainingData</span><span class="o">,</span><span class="n">decisionTestData</span><span class="o">)</span> <span class="k">=</span> <span class="n">decisionTreeData</span><span class="o">.</span><span class="n">randomSplit</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="mf">0.8</span><span class="o">,</span><span class="mf">0.2</span><span class="o">))</span>
    <span class="c1">//使用Pipline进行计算
</span>    <span class="k">val</span> <span class="n">decisionPipline</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Pipeline</span><span class="o">()</span>
        <span class="o">.</span><span class="n">setStages</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="n">label</span><span class="o">,</span><span class="n">feature</span><span class="o">,</span><span class="n">dtc</span><span class="o">,</span><span class="n">convertor</span><span class="o">))</span>
    <span class="c1">//训练决策树模型
</span>    <span class="k">val</span> <span class="n">decisionModel</span> <span class="k">=</span> <span class="n">decisionPipline</span><span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">decisionTrainingData</span><span class="o">)</span>
    <span class="c1">//使用决策树模型进行预测
</span>    <span class="k">val</span> <span class="n">decisionPredictions</span> <span class="k">=</span> <span class="n">decisionModel</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">decisionTestData</span><span class="o">)</span>
    <span class="c1">//输出预测结果
</span>    <span class="n">decisionPredictions</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"predictionLabel"</span><span class="o">,</span><span class="s">"label"</span><span class="o">,</span><span class="s">"features"</span><span class="o">).</span><span class="n">show</span><span class="o">()</span>
    <span class="k">val</span> <span class="n">decisionTreeModel</span> <span class="k">=</span> <span class="n">decisionModel</span><span class="o">.</span><span class="n">stages</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">DecisionTreeClassificationModel</span><span class="o">]</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Learned classification tree model:\n"</span> <span class="o">+</span> <span class="n">decisionTreeModel</span><span class="o">.</span><span class="n">toDebugString</span><span class="o">)</span>

    <span class="c1">//误差评估
</span>    <span class="k">val</span> <span class="n">decisionEvaluator</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MulticlassClassificationEvaluator</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setLabelCol</span><span class="o">(</span><span class="s">"indexedLabel"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setPredictionCol</span><span class="o">(</span><span class="s">"prediction"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setMetricName</span><span class="o">(</span><span class="s">"accuracy"</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">decisionAccuracy</span> <span class="k">=</span> <span class="n">decisionEvaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="o">(</span><span class="n">decisionPredictions</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Test Error = "</span> <span class="o">+</span> <span class="o">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">decisionAccuracy</span><span class="o">))</span>

    <span class="n">println</span><span class="o">(</span><span class="s">"----------Random Forest Classifier------------"</span><span class="o">)</span>

    <span class="k">val</span> <span class="n">rfc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">RandomForestClassifier</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setLabelCol</span><span class="o">(</span><span class="s">"indexedLabel"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setFeaturesCol</span><span class="o">(</span><span class="s">"indexedFeatures"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setNumTrees</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">randomModel</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Pipeline</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setStages</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="n">label</span><span class="o">,</span><span class="n">feature</span><span class="o">,</span><span class="n">rfc</span><span class="o">,</span><span class="n">convertor</span><span class="o">))</span>
      <span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">decisionTrainingData</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">randomPredictions</span> <span class="k">=</span> <span class="n">randomModel</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">decisionTestData</span><span class="o">)</span>
    <span class="n">randomPredictions</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"predictionLabel"</span><span class="o">,</span><span class="s">"label"</span><span class="o">,</span><span class="s">"features"</span><span class="o">).</span><span class="n">show</span><span class="o">()</span>
    <span class="k">val</span> <span class="n">randomForestModel</span> <span class="k">=</span> <span class="n">randomModel</span><span class="o">.</span><span class="n">stages</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">RandomForestClassificationModel</span><span class="o">]</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Learned classification tree model:\n"</span> <span class="o">+</span> <span class="n">randomForestModel</span><span class="o">.</span><span class="n">toDebugString</span><span class="o">)</span>
    <span class="c1">//误差评估
</span>    <span class="k">val</span> <span class="n">randomEvaluator</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MulticlassClassificationEvaluator</span><span class="o">()</span>
      <span class="o">.</span><span class="n">setLabelCol</span><span class="o">(</span><span class="s">"indexedLabel"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setPredictionCol</span><span class="o">(</span><span class="s">"prediction"</span><span class="o">)</span>
      <span class="o">.</span><span class="n">setMetricName</span><span class="o">(</span><span class="s">"accuracy"</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">randomAccuracy</span> <span class="k">=</span> <span class="n">randomEvaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="o">(</span><span class="n">randomPredictions</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Test Error = "</span> <span class="o">+</span> <span class="o">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">randomAccuracy</span><span class="o">))</span></code></pre></div>

<p>测试结果:</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="o">----------</span><span class="n">Decision</span> <span class="n">Tree</span> <span class="n">Classifier</span> <span class="n">Test</span><span class="o">------------</span>
<span class="o">+---------------+-----+--------------------+</span>
<span class="o">|</span><span class="n">predictionLabel</span><span class="o">|</span><span class="n">label</span><span class="o">|</span>            <span class="n">features</span><span class="o">|</span>
<span class="o">+---------------+-----+--------------------+</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">.</span><span class="mi">3</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">.</span><span class="mi">2</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">...</span><span class="o">|</span>
<span class="o">+---------------+-----+--------------------+</span>

<span class="n">Learned</span> <span class="n">classification</span> <span class="n">tree</span> <span class="n">model</span><span class="o">:</span>
<span class="n">DecisionTreeClassificationModel</span> <span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="n">dtc_c0a4ddb1e0bc</span><span class="p">)</span> <span class="n">of</span> <span class="n">depth</span> <span class="mi">2</span> <span class="n">with</span> <span class="mi">7</span> <span class="n">nodes</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">in</span> <span class="p">{</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
    <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
   <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
    <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
    <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
   <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
    <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>

<span class="n">Test</span> <span class="n">Error</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>

<span class="o">----------</span><span class="n">Random</span> <span class="n">Forest</span> <span class="n">Classifier</span><span class="o">------------</span>

<span class="o">+---------------+-----+--------------------+</span>
<span class="o">|</span><span class="n">predictionLabel</span><span class="o">|</span><span class="n">label</span><span class="o">|</span>            <span class="n">features</span><span class="o">|</span>
<span class="o">+---------------+-----+--------------------+</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">.</span><span class="mi">3</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">.</span><span class="mi">2</span><span class="p">])</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">...</span><span class="o">|</span>
<span class="o">|</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">...</span><span class="o">|</span>
<span class="o">+---------------+-----+--------------------+</span>

<span class="n">Learned</span> <span class="n">classification</span> <span class="n">tree</span> <span class="n">model</span><span class="o">:</span>
<span class="n">RandomForestClassificationModel</span> <span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="n">rfc_daac961a24b6</span><span class="p">)</span> <span class="n">with</span> <span class="mi">5</span> <span class="n">trees</span>
  <span class="n">Tree</span> <span class="mi">0</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">in</span> <span class="p">{</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
      <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
     <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
        <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
       <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
        <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
      <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">Tree</span> <span class="mi">1</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
      <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
     <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
      <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">Tree</span> <span class="mi">2</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
     <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
      <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">Tree</span> <span class="mi">3</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">.</span><span class="mi">9</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">in</span> <span class="p">{</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
      <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
     <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">.</span><span class="mi">9</span><span class="p">)</span>
      <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">Tree</span> <span class="mi">4</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
    <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">0</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
     <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
     <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>
      <span class="n">Else</span> <span class="p">(</span><span class="n">feature</span> <span class="mi">1</span> <span class="n">not</span> <span class="n">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
       <span class="n">Predict</span><span class="o">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
       
<span class="n">Test</span> <span class="n">Error</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span></code></pre></div>


</article>
<p class="lotus-anno">声明: 本文采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="nofollow" target="_blank" title="自由转载-非商用-非衍生-保持署名">BY-NC-SA</a> 授权。转载请注明转自: <a href="" title="" rel="nofollow">phy</a></p>
<section class="lotus-nextpage fn-clear">
    
    <div class="lotus-nextpage-left"><a class="prev" href="/2016/09/03/logisticregression.html" rel="prev">&laquo;&nbsp;机器学习算法之逻辑回归</a></div>
    
    
    <div class="lotus-nextpage-right"><a class="next" href="/2016/09/10/sparkdatasets.html" rel="next">Spark DataFrames and Datasets&nbsp;&raquo;</a></div>
    
</section>

<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="/2016/09/04/randomforest" data-title="机器学习算法之决策树和随机森林" data-url="/2016/09/04/randomforest.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"pp1230"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->




<footer class="lotus-footer">
	<p>Copyright © 2010–2015 PHY的博客 All rights reserved. On github <a href="https://github.com/pp1230" target="_blank">pp1230</a>.</p>
</footer>
<script src="http://pp1230.github.io/static/js/jquery.scrollTo.js" type="text/javascript"></script>
<script src="http://pp1230.github.io/static/js/iLotus.js" type="text/javascript"></script>
</body>
</html>
